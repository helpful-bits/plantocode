# infrastructure/ansible/group_vars/all/secrets.yml.example
# This is an example of the secrets file structure.
# Copy this to secrets.yml and fill in your actual values, then encrypt with:
# ansible-vault encrypt group_vars/all/secrets.yml --vault-password-file .vault_pass

# PostgreSQL Credentials
db_name: appdb
db_user: appuser
db_password: "CHANGE_ME_strong_random_password_here"

# Redis Password
redis_password: "CHANGE_ME_another_strong_random_password"

# Application Secrets
jwt_secret: "CHANGE_ME_very_long_random_string_for_jwt_signing"

# API Keys
openrouter_api_key: "sk-or-v1-YOUR_OPENROUTER_API_KEY"
openai_api_key: "sk-proj-YOUR_OPENAI_API_KEY"
xai_api_key: "xai-YOUR_XAI_API_KEY"
anthropic_api_key: "sk-ant-api03-YOUR_ANTHROPIC_API_KEY"
google_api_keys: "YOUR_GOOGLE_API_KEY1,YOUR_GOOGLE_API_KEY2"

# Auth0 Configuration
auth0_domain: "your-tenant.auth0.com"
auth0_api_audience: "https://your-api-identifier"
auth0_server_client_id: "YOUR_AUTH0_M2M_CLIENT_ID"
auth0_server_client_secret: "YOUR_AUTH0_M2M_CLIENT_SECRET"

# Other secrets
refresh_token_encryption_key: "64_hex_characters_for_encryption_key"
audit_hmac_secret: "CHANGE_ME_strong_secret_for_audit_integrity"
featurebase_sso_secret: "fb-YOUR-FEATUREBASE-SSO-SECRET"

# Stripe Configuration
stripe_publishable_key: "pk_test_YOUR_STRIPE_PUBLISHABLE_KEY"
stripe_secret_key: "sk_test_YOUR_STRIPE_SECRET_KEY"
# Note: stripe_webhook_secret is now defined per host in group_vars/{hetzner,interserver}/secrets.yml

# Mailgun Configuration
mailgun_api_key: "YOUR_MAILGUN_API_KEY"
mailgun_domain: "YOUR_MAILGUN_DOMAIN"

# Complete Application Environment Variables
# This section defines ALL environment variables that will be written to /opt/plantocode/config/app.env
# The file will be completely replaced on each deploy to ensure no stale variables
app_env_vars:
  # Server Application Configuration
  APP_NAME: "plantocode"
  ENVIRONMENT: "production"  # or "development", "staging"
  RUST_LOG: "info,plantocode=debug"
  
  # Database Configuration
  DATABASE_URL: "postgresql://{{ db_user }}:{{ db_password }}@localhost:5432/{{ db_name }}"
  SQLX_OFFLINE: "true"
  
  # Server Network Configuration
  SERVER_HOST: "0.0.0.0"
  SERVER_PORT: "8080"
  CORS_ORIGINS: "*"  # Configure appropriately for production
  SERVER_URL: "https://api.yourdomain.com"  # Your actual API URL
  SERVER_CLIENT_REQUEST_TIMEOUT_SECS: "1740"
  
  # API Keys (references to variables defined above)
  OPENROUTER_API_KEY: "{{ openrouter_api_key }}"
  OPENAI_API_KEY: "{{ openai_api_key }}"
  XAI_API_KEY: "{{ xai_api_key }}"
  ANTHROPIC_API_KEY: "{{ anthropic_api_key }}"
  GOOGLE_API_KEYS: "{{ google_api_keys }}"
  
  # Auth0 Configuration
  AUTH0_DOMAIN: "{{ auth0_domain }}"
  AUTH0_API_AUDIENCE: "{{ auth0_api_audience }}"
  AUTH0_SERVER_CLIENT_ID: "{{ auth0_server_client_id }}"
  AUTH0_SERVER_CLIENT_SECRET: "{{ auth0_server_client_secret }}"
  SERVER_AUTH0_CALLBACK_URL: "https://api.yourdomain.com/auth/auth0/callback"
  SERVER_AUTH0_LOGGED_OUT_URL: "https://api.yourdomain.com/auth/auth0/logged-out"
  
  # Authentication Configuration
  JWT_SECRET: "{{ jwt_secret }}"
  JWT_ACCESS_TOKEN_DURATION_DAYS: "1"
  
  # Featurebase SSO Configuration
  FEATUREBASE_SSO_SECRET: "{{ featurebase_sso_secret }}"
  
  # Refresh Token Encryption Configuration
  REFRESH_TOKEN_ENCRYPTION_KEY: "{{ refresh_token_encryption_key }}"
  
  # Audit Security Configuration
  AUDIT_HMAC_SECRET: "{{ audit_hmac_secret }}"
  
  # Redis Configuration
  REDIS_URL: "redis://:{{ redis_password }}@127.0.0.1:6379"
  
  # Rate Limiting Configuration
  RATE_LIMIT_WINDOW_MS: "60000"
  RATE_LIMIT_MAX_REQUESTS: "100"
  RATE_LIMIT_CLEANUP_INTERVAL_SECS: "300"
  
  # Account Creation Rate Limiting Configuration
  ACCOUNT_CREATION_RATE_LIMIT_WINDOW_MS: "3600000"
  ACCOUNT_CREATION_RATE_LIMIT_MAX_REQUESTS: "8"
  
  # Auth Store Configuration
  POLLING_STORE_EXPIRY_MINS: "30"
  AUTH0_STATE_STORE_EXPIRY_MINS: "30"
  AUTH_STORE_CLEANUP_INTERVAL_SECS: "300"
  
  # Billing Configuration
  DEFAULT_SIGNUP_CREDITS: "5.0"
  
  # Stripe Configuration
  STRIPE_PUBLISHABLE_KEY: "{{ stripe_publishable_key }}"
  STRIPE_SECRET_KEY: "{{ stripe_secret_key }}"
  # Webhook secret is host-specific - see group_vars/{hetzner,interserver}/secrets.yml
  STRIPE_WEBHOOK_SECRET: "{{ stripe_webhook_secret_hetzner | default(stripe_webhook_secret_interserver) }}"
  STRIPE_CHECKOUT_SUCCESS_URL: "https://yourdomain.com/account?checkout=success"
  STRIPE_CHECKOUT_CANCEL_URL: "https://yourdomain.com/account?checkout=canceled"
  STRIPE_PORTAL_RETURN_URL: "https://yourdomain.com/account"
  
  # Deep Link Configuration
  APP_DEEP_LINK_SCHEME: "plantocode"
  
  # Website Base URL
  WEBSITE_BASE_URL: "https://yourdomain.com"
  
  # Email Configuration (Mailgun)
  MAILGUN_API_KEY: "{{ mailgun_api_key }}"
  MAILGUN_DOMAIN: "{{ mailgun_domain }}"
  FROM_EMAIL: "noreply@yourdomain.com"
  FROM_NAME: "Your App Name"
  MAILGUN_BASE_URL: "https://api.mailgun.net"
  ADMIN_EMAIL_RECIPIENT: "admin@yourdomain.com"